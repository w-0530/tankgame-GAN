# 🎮 Tank Game AI

基于深度强化学习的坦克游戏AI项目

## 📁 项目结构

```
tankgame-GAN/
├── tankgame.py     # 游戏核心代码
├── train.py        # 1000回合AI训练脚本  
├── test.py         # 模型性能测试脚本
├── best_model.pth  # 训练过程中的最佳模型
└── backup_model_ep200.pth  # 训练备份模型
```

## 🚀 快速开始

### 1. 训练AI模型
```bash
python train.py
```
- 自动训练1000回合
- 包含智能探索策略
- 保存最佳模型为 `best_model.pth`
- 每50回合报告进度

### 2. 测试模型性能

```bash
python test.py
```
会自动测试所有可用模型并显示性能对比：
- 🏆 优秀 (>100分)
- 🥈 良好 (50-100分)  
- 🥉 及格 (0-50分)
- ❌ 不及格 (0分)

## 🧠 AI特性

### 🏗️ 网络架构
- **紧凑设计**: 33→64→32 (相比原来缩小50%)
- **双头输出**: 移动控制 + 瞄准控制
- **LayerNorm**: 提升训练稳定性

### 🎯 训练优化
- **高效经验回放**: 使用deque缓冲区(15k容量)
- **自适应学习率**: 基于性能自动调整
- **梯度累积**: 模拟大批次训练
- **早停机制**: 100轮无改进自动停止
- **动态损失权重**: 自平衡移动/瞄准重要性

### 📊 关键参数
- 批次大小: 256
- 学习率: 0.0005 (自适应)
- 折扣因子: 0.95
- 目标网络更新: 每500步

## 🎮 游戏控制

### 手动游戏模式
```python
import tankgame
game = tankgame.TankGame()
game.manual_play()
```

**控制方式:**
- W/A/S/D: 坦克移动
- ←/→: 炮管旋转  
- 空格: 射击
- Q: 退出

### 游戏规则
- 🟢 绿色坦克: 玩家/AI
- 🔵 蓝色坦克: 敌方AI
- 🟡 黄色圆点: 玩家子弹
- 🔴 红色圆点: 敌方子弹
- ⏱️ 60秒时间限制
- 5条生命值

## 📈 性能指标

### 状态空间 (33维)
- 玩家信息: 位置、角度、生命、冷却 (5维)
- 最近敌人: 位置、距离、角度、生命 (7维)  
- 敌人子弹威胁: 最多6颗子弹的位置和威胁度 (18维)
- 战术信息: 安全区域、优势位置 (3维)
- 时间压力: 剩余时间 (1维)

### 动作空间
- 移动: 静止、上下左右 (5种)
- 瞄准: 左转、右转、射击 (3种)

## 🏆 当前性能

### 最佳模型 (best_model.pth)
- **平均游戏分数**: 182.0分
- **最高分数**: 280分
- **平均击杀数**: 2.6个敌人
- **性能评价**: 🏆 优秀

### 训练改进历程
- **原始模型**: 0分 (无法击杀)
- **改进版本**: 0分 (训练不稳定)  
- **激进版本**: 0分 (过度优化)
- **最终版本**: 182分 (🏆优秀)

### 模型特点
- **网络架构**: 67→128→96 (优化设计)
- **训练策略**: Double DQN + 智能探索
- **核心改进**: 强化击杀奖励 (30倍)
- **文件大小**: ~45KB

## 🔧 环境要求

- Python 3.13+
- PyTorch 2.0+
- Pygame 2.6.1+
- NumPy

## 📝 使用示例

### 训练新模型
```bash
python train.py
```

### 测试模型性能
```bash
# 测试所有可用模型
python test.py
```

### 手动游戏
```python
import tankgame
game = tankgame.TankGame()
game.manual_play()
```

---

**项目状态**: 🏆 训练完成，性能优秀  
**最后更新**: 2025年02月10日  
**训练轮次**: 1000回合 (可继续训练提升)